namespace = fund_inspiration

scripted_effect fund_inspiration_0031_pick_options_to_show_effect = {
	#What options should we show?
	hidden_effect = {
		random_list = {
			800 = { # Have I ever restored/unified/formed/created/founded a kingdom/empire/etc.?
				trigger = {
					fund_inspiration_0031_title_based_option_trigger = yes
				}
				if = {
					limit = {
						AND = {
							exists = global_var:flag_restored_roman_empire
							global_var:flag_restored_roman_empire = root
						}
						NOT = { exists = scope:book_topic_restoration }
					}
					save_scope_value_as = {
						name = book_topic_restoration
						value = yes
					}
					title:h_roman_empire = {
						save_scope_as = restored_title
					}
				}
                if = {
					limit = {
						AND = {
							exists = global_var:flag_restored_romaviri_empire
							global_var:flag_restored_romaviri_empire = root
						}
						NOT = { exists = scope:book_topic_restoration }
					}
					save_scope_value_as = {
						name = book_topic_restoration
						value = yes
					}
					title:h_romaviri_empire = {
						save_scope_as = restored_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_restored_dumnonia
							global_var:flag_restored_dumnonia = root
						}
						NOT = { exists = scope:book_topic_restoration }
					}
					save_scope_value_as = {
						name = book_topic_restoration
						value = yes
					}
					title:k_cornwall = {
						save_scope_as = restored_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_reformed_carolingian_empire
							global_var:flag_reformed_carolingian_empire = root
						}
						NOT = { exists = scope:book_topic_restoration }
					}
					save_scope_value_as = {
						name = book_topic_restoration
						value = yes
					}
					title:e_france = {
						save_scope_as = restored_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:restore_holy_roman_empire_decision
							global_var:restore_holy_roman_empire_decision = root
						}
						NOT = { exists = scope:book_topic_restoration }
					}
					save_scope_value_as = {
						name = book_topic_restoration
						value = yes
					}
					title:e_hre = {
						save_scope_as = restored_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:unite_the_spanish_thrones_decision
							global_var:unite_the_spanish_thrones_decision = root
							exists = global_var:unite_the_spanish_thrones_decision_title
						}
						NOT = { exists = scope:book_topic_unification }
					}
					save_scope_value_as = {
						name = book_topic_unification
						value = yes
					}
					global_var:unite_the_spanish_thrones_decision_title = {
						save_scope_as = united_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:unite_the_slavs_decision
							global_var:unite_the_slavs_decision = root
						}
						NOT = { exists = scope:book_topic_unification }
					}
					save_scope_value_as = {
						name = book_topic_unification
						value = yes
					}
					title:e_slavia = {
						save_scope_as = united_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:unite_the_southern_slavs_decision
							global_var:unite_the_southern_slavs_decision = root
							exists = global_var:unite_the_southern_slavs_decision_title
						}
						NOT = { exists = scope:book_topic_unification }
					}
					save_scope_value_as = {
						name = book_topic_unification
						value = yes
					}
					global_var:unite_the_southern_slavs_decision_title = {
						save_scope_as = united_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:unite_the_western_slavs_decision
							global_var:unite_the_western_slavs_decision = root
							exists = global_var:unite_the_western_slavs_decision_title
						}
						NOT = { exists = scope:book_topic_unification }
					}
					save_scope_value_as = {
						name = book_topic_unification
						value = yes
					}
					global_var:unite_the_western_slavs_decision_title = {
						save_scope_as = united_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_unified_burgundy_kingdom
							global_var:flag_unified_burgundy_kingdom = root
						}
						NOT = { exists = scope:book_topic_unification }
					}
					save_scope_value_as = {
						name = book_topic_unification
						value = yes
					}
					title:k_burgundy = {
						save_scope_as = united_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_unified_italian_empire
							global_var:flag_unified_italian_empire = root
						}
						NOT = { exists = scope:book_topic_unification }
					}
					save_scope_value_as = {
						name = book_topic_unification
						value = yes
					}
					title:e_italy = {
						save_scope_as = united_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:form_portugal_decision
							global_var:form_portugal_decision = root
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					title:k_portugal = {
						save_scope_as = created_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_founded_kingdom_of_bosnia
							global_var:flag_founded_kingdom_of_bosnia = root
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					title:k_bosnia = {
						save_scope_as = created_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_created_armenian_empire
							global_var:flag_created_armenian_empire = root
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					title:e_armenia = {
						save_scope_as = created_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_created_dai_viet_empire
							global_var:flag_created_dai_viet_empire = root
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					title:e_viet = {
						save_scope_as = created_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_formed_rum_sultanate
							global_var:flag_formed_rum_sultanate = root
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					title:k_rum = {
						save_scope_as = created_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:create_israel_kingdom
							global_var:create_israel_kingdom = root
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					title:k_israel = {
						save_scope_as = created_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_created_outremer_empire
							global_var:flag_created_outremer_empire = root
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					title:e_outremer = {
						save_scope_as = created_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_formed_switzerland_kingdom
							global_var:flag_formed_switzerland_kingdom = root
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					title:k_switzerland = {
						save_scope_as = created_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_formed_austria_kingdom
							global_var:flag_formed_austria_kingdom = root
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					title:k_austria = {
						save_scope_as = created_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:flag_formed_kingdom_of_aragon
							global_var:flag_formed_kingdom_of_aragon = root
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					title:k_aragon = {
						save_scope_as = created_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:found_kingdom_decision
							global_var:found_kingdom_decision = root
							exists =  global_var:found_kingdom_decision_kingdom
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					global_var:found_kingdom_decision_kingdom = {
						save_scope_as = created_title
					}
				}
				else_if = {
					limit = {
						AND = {
							exists = global_var:found_empire_decision
							global_var:found_empire_decision = root
							exists =  global_var:found_empire_decision_empire
						}
						NOT = { exists = scope:book_topic_creation }
					}
					save_scope_value_as = {
						name = book_topic_creation
						value = yes
					}
					global_var:found_empire_decision_empire = {
						save_scope_as = created_title
					}
				}
			}
			5 = { # Dynasty
				trigger = {
					fund_inspiration_0031_dynasty_option_trigger = yes
				}
				save_scope_value_as = {
					name = dynasty_option
					value = yes
				}
			}
			10 = { # education trait
				trigger = {
					fund_inspiration_0031_education_option_trigger = yes
				}
				save_scope_value_as = {
					name = education_option
					value = yes
				}
			}
			10 = { # lifestyle/misc stuff
				trigger = {
					fund_inspiration_0031_lifestyle_option_trigger = yes
				}
				save_scope_value_as = {
					name = lifestyle_option
					value = yes
				}
				random_list = { #What topic do we offer you?
					10 = {
						trigger = { has_trait = lifestyle_reveler }
						save_scope_value_as = {
							name = lifestyle_option_reveler
							value = yes
						}
					}
					10 = {
						trigger = { has_trait = lifestyle_blademaster }
						save_scope_value_as = {
							name = lifestyle_option_blademaster
							value = yes
						}
					}
					10 = {
						trigger = { has_trait = lifestyle_hunter }
						save_scope_value_as = {
							name = lifestyle_option_hunter
							value = yes
						}
					}
					10 = {
						trigger = { has_trait = lifestyle_mystic }
						save_scope_value_as = {
							name = lifestyle_option_mystic
							value = yes
						}
					}
					10 = {
						trigger = { has_trait = lifestyle_herbalist }
						save_scope_value_as = {
							name = lifestyle_option_herbalist
							value = yes
						}
					}
					10 = {
						trigger = { has_trait = lifestyle_physician }
						save_scope_value_as = {
							name = lifestyle_option_physician
							value = yes
						}
					}
					10 = {
						trigger = { is_cannibal_trigger = yes }
						save_scope_value_as = {
							name = lifestyle_option_cannibal
							value = yes
						}
					}
					10 = {
						trigger = { is_witch_trigger = yes }
						save_scope_value_as = {
							name = lifestyle_option_witch
							value = yes
						}
					}
					10 = {
						trigger = { is_deviant_trigger = yes }
						save_scope_value_as = {
							name = lifestyle_option_deviant
							value = yes
						}
					}
					10 = {
						trigger = { has_trait = lunatic }
						save_scope_value_as = {
							name = lifestyle_option_lunatic
							value = yes
						}
					}
					10 = {
						trigger = { has_trait = torturer }
						save_scope_value_as = {
							name = lifestyle_option_torturer
							value = yes
						}
					}
				}
			}
			10 = { # focus
				trigger = {
					fund_inspiration_0031_focus_option_trigger = yes
				}
				save_scope_value_as = {
					name = focus_option
					value = yes
				}
			}
			5 = { # relationship
				trigger = {
					fund_inspiration_0031_relationship_option_trigger = yes
				}
				save_scope_value_as = {
					name = relationship_option
					value = yes
				}
				if = {
					limit = {
						any_relation = {
							type = soulmate
							this != scope:inspiration_owner
						}
					}
					random_relation = {
						type = soulmate
						limit = {
							this != scope:inspiration_owner
						}
						save_scope_as = relationship_scope
					}
					save_scope_value_as = {
						name = relationship_option_soulmate
						value = yes
					}
				}
				else_if = {
					limit = {
						any_relation = {
							type = nemesis
							this != scope:inspiration_owner
						}
					}
					random_relation = {
						type = nemesis
						limit = {
							this != scope:inspiration_owner
						}
						save_scope_as = relationship_scope
					}
					save_scope_value_as = {
						name = relationship_option_nemesis
						value = yes
					}
				}
			}
			50 = { # mystical animal
				trigger = {
					fund_inspiration_0031_mystical_animal_option_trigger = yes
				}
				save_scope_value_as = {
					name = mystical_animal_option
					value = yes
				}
				set_variable = {
					name = animal_type
					value = root.var:hunted_mystical_animal
				}
			}
			5 = { # pet (only if we don't have enough options already)
				trigger = {
					fund_inspiration_0031_pet_option_trigger = yes
				}
				save_scope_value_as = {
					name = pet_option
					value = yes
				}
				random_list = {
					50 = {
						trigger = {
							any_owned_story = {
								type = story_cycle_pet_cat
							}
							exists = var:story_cycle_cat_name
						}
						save_scope_value_as = {
							name = pet_option_cat
							value = yes
						}
					}
					50 = {
						trigger = {
							any_owned_story = {
								type = story_cycle_pet_dog
							}
						}
						save_scope_value_as = {
							name = pet_option_dog
							value = yes
						}
					}
				}
			}
			1 = { # skill (only if we don't have enough options already)
				trigger = {
					fund_inspiration_0031_skill_option_trigger = yes
				}
				save_scope_value_as = {
					name = skill_option
					value = yes
				}
				if = {
					limit = {
						highest_skill = martial
						NOT = { has_education_martial_trigger = yes }
						trigger_if = {
							limit = {
								exists = scope:focus_option
							}
							has_focus_martial = no
						}
					}
					save_scope_value_as = {
						name = skill_option_martial
						value = yes
					}
				}
				else_if = {
					limit = {
						highest_skill = diplomacy
						NOT = { has_education_diplomacy_trigger = yes }
						trigger_if = {
							limit = {
								exists = scope:focus_option
							}
							has_focus_diplomacy = no
						}
					}
					save_scope_value_as = {
						name = skill_option_diplomacy
						value = yes
					}
				}
				else_if = {
					limit = {
						highest_skill = stewardship
						NOT = { has_education_stewardship_trigger = yes }
						trigger_if = {
							limit = {
								exists = scope:focus_option
							}
							has_focus_stewardship = no
						}
					}
					save_scope_value_as = {
						name = skill_option_stewardship
						value = yes
					}
				}
				else_if = {
					limit = {
						highest_skill = intrigue
						NOT = { has_education_intrigue_trigger = yes }
						trigger_if = {
							limit = {
								exists = scope:focus_option
							}
							has_focus_intrigue = no
						}
					}
					save_scope_value_as = {
						name = skill_option_intrigue
						value = yes
					}
				}
				else_if = {
					limit = {
						highest_skill = learning
						NOT = { has_education_learning_trigger = yes }
						trigger_if = {
							limit = {
								exists = scope:focus_option
							}
							has_focus_learning = no
						}
					}
					save_scope_value_as = {
						name = skill_option_learning
						value = yes
					}
				}
				else = { #Fallback
					random_list = {
						1 = {
							trigger = {
								NOT = { has_education_martial_trigger = yes }
								trigger_if = {
									limit = {
										exists = scope:focus_option
									}
									has_focus_martial = no
								}
								OR = { #Cannot be the lowest skill
									martial > diplomacy
									martial > stewardship
									martial > intrigue
									martial > learning
								}
							}
							compare_modifier = {
								value = martial
								multiplier = 4
							}
							save_scope_value_as = {
								name = skill_option_martial
								value = yes
							}
						}
						1 = {
							trigger = {
								NOT = { has_education_diplomacy_trigger = yes }
								trigger_if = {
									limit = {
										exists = scope:focus_option
									}
									has_focus_diplomacy = no
								}
								OR = { #Cannot be the lowest skill
									diplomacy > martial
									diplomacy > stewardship
									diplomacy > intrigue
									diplomacy > learning
								}
							}
							compare_modifier = {
								value = diplomacy
								multiplier = 4
							}
							save_scope_value_as = {
								name = skill_option_diplomacy
								value = yes
							}
						}
						1 = {
							trigger = {
								NOT = { has_education_stewardship_trigger = yes }
								trigger_if = {
									limit = {
										exists = scope:focus_option
									}
									has_focus_stewardship = no
								}
								OR = { #Cannot be the lowest skill
									stewardship > martial
									stewardship > diplomacy
									stewardship > intrigue
									stewardship > learning
								}
							}
							compare_modifier = {
								value = stewardship
								multiplier = 4
							}
							save_scope_value_as = {
								name = skill_option_stewardship
								value = yes
							}
						}
						1 = {
							trigger = {
								NOT = { has_education_intrigue_trigger = yes }
								trigger_if = {
									limit = {
										exists = scope:focus_option
									}
									has_focus_intrigue = no
								}
								OR = { #Cannot be the lowest skill
									intrigue > martial
									intrigue > diplomacy
									intrigue > stewardship
									intrigue > learning
								}
							}
							compare_modifier = {
								value = intrigue
								multiplier = 4
							}
							save_scope_value_as = {
								name = skill_option_intrigue
								value = yes
							}
						}
						1 = {
							trigger = {
								NOT = { has_education_learning_trigger = yes }
								trigger_if = {
									limit = {
										exists = scope:focus_option
									}
									has_focus_learning = no
								}
								OR = { #Cannot be the lowest skill
									learning > martial
									learning > diplomacy
									learning > stewardship
									learning > intrigue
								}
							}
							compare_modifier = {
								value = learning
								multiplier = 4
							}
							save_scope_value_as = {
								name = skill_option_learning
								value = yes
							}
						}
					}
				}
			}
		}
	}
}